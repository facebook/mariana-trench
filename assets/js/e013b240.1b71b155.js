"use strict";(globalThis.webpackChunkwebsite=globalThis.webpackChunkwebsite||[]).push([[3128,3855],{81742(e,n,s){s.r(n),s.d(n,{assets:()=>l,contentTitle:()=>d,default:()=>m,frontMatter:()=>c,metadata:()=>r,toc:()=>u});const r=JSON.parse('{"id":"customize-sources-and-sinks","title":"Customize Sources and Sinks","description":"This page provides a high-level overview of the steps needed to update or create new sources and sinks.","source":"@site/documentation/customize_sources_and_sinks.md","sourceDirName":".","slug":"/customize-sources-and-sinks","permalink":"/docs/customize-sources-and-sinks","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/mariana-trench/tree/main/documentation/website/documentation/customize_sources_and_sinks.md","tags":[],"version":"current","frontMatter":{"id":"customize-sources-and-sinks","title":"Customize Sources and Sinks","sidebar_label":"Customize Sources and Sinks"},"sidebar":"docs","previous":{"title":"Analysis Configuration Options","permalink":"/docs/configuration"},"next":{"title":"Rules","permalink":"/docs/rules"}}');var t=s(74848),o=s(28453),i=s(52112),a=s(88447);const c={id:"customize-sources-and-sinks",title:"Customize Sources and Sinks",sidebar_label:"Customize Sources and Sinks"},d=void 0,l={},u=[{value:"Overview",id:"overview",level:2},...a.toc];function h(e){const n={a:"a",code:"code",h2:"h2",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,o.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.p,{children:"This page provides a high-level overview of the steps needed to update or create new sources and sinks."}),"\n",(0,t.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,t.jsxs)(n.p,{children:["Under the context of Mariana Trench, we talk about sources and sinks in terms of methods (or, rarely, fields). For example, we may say that the return value of a method is a source (or a sink). We may also say that the 2nd parameter of a method is a source (or a sink). Such description of a method is called a ",(0,t.jsx)(n.strong,{children:'"model"'}),". See ",(0,t.jsx)(n.a,{href:"/docs/models",children:"Models & Model Generators"})," for more details about models and writing them."]}),"\n",(0,t.jsx)(i.FbInternalOnly,{children:(0,t.jsx)(a.default,{})}),"\n",(0,t.jsxs)(i.OssOnly,{children:[(0,t.jsxs)(n.p,{children:["To define sources or sinks that are not contained in the default set of ",(0,t.jsx)(n.a,{href:"https://github.com/facebook/mariana-trench/tree/main/configuration/model-generators/sources",children:"sources"})," and ",(0,t.jsx)(n.a,{href:"https://github.com/facebook/mariana-trench/tree/main/configuration/model-generators/sinks",children:"sinks"}),", a user needs to:"]}),(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:["Write one or more JSON files that respect our ",(0,t.jsx)(n.a,{href:"/docs/models",children:"model generator Domain Specific Language (DSL)"}),", which express how to generate models from methods and are hence called ",(0,t.jsx)(n.strong,{children:'"model generators"'}),"."]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["For example, a model generator may say that, for all methods (that will be analyzed by Mariana Trench) whose name is ",(0,t.jsx)(n.code,{children:"onActivityResult"}),", specify their 2nd parameter as a source."]}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n  "model_generators": [\n    {\n      "find": "methods",\n      "where": [\n        {\n          "constraint": "name",\n          "pattern": "onActivityResult"\n        }\n      ],\n      "model": {\n        "sources": [\n          {\n            "kind": "TestSensitiveUserInput",\n            "port": "Argument(2)"\n          }\n        ]\n      }\n    }\n  ]\n}\n'})}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Instruct Mariana Trench to read from your model generator, so that Mariana Trench will generate models at runtime."}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Intuitively, the models generated (by interpreting model generators) express sources and sinks for each method ",(0,t.jsx)(n.strong,{children:"before"})," running Mariana Trench. Based on such models, Mariana Trench will automatically infer ",(0,t.jsx)(n.strong,{children:"new"})," models for each method at runtime."]}),"\n",(0,t.jsxs)(n.li,{children:["To instruct Mariana Trench to read from customized JSON model generators, add your json model generator ",(0,t.jsx)(n.a,{href:"https://github.com/facebook/mariana-trench/tree/main/configuration/model-generators",children:"here"}),"."]}),"\n",(0,t.jsxs)(n.li,{children:["Add the model generator name (i.e, the file name) in the ",(0,t.jsx)(n.a,{href:"https://github.com/facebook/mariana-trench/blob/main/configuration/default_generator_config.json",children:"JSON configuration file"}),"."]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:["Update ",(0,t.jsx)(n.strong,{children:'"rules"'})," if necessary."]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Background: Mariana Trench categorizes sources and sinks into different ",(0,t.jsx)(n.strong,{children:'"kinds"'}),", which are string-typed. For example, a source may have a kind of",(0,t.jsx)(n.code,{children:"JavascriptInterfaceUserInput"}),". A sink may have a kind of ",(0,t.jsx)(n.code,{children:"Logging"}),". Mariana Trench only finds data flow ",(0,t.jsx)(n.strong,{children:"from sources of a particular kind to sinks of another particular kind"}),", which are called ",(0,t.jsx)(n.strong,{children:'"rules"'}),". See ",(0,t.jsx)(n.a,{href:"/docs/rules",children:"Rules"})," for writing them."]}),"\n",(0,t.jsxs)(n.li,{children:["To specify kinds that are not mentioned in the default set of rules or to specify rules that are different than the default rules, you need to specify a new rule in file ",(0,t.jsx)(n.a,{href:"https://github.com/facebook/mariana-trench/blob/main/configuration/rules.json",children:(0,t.jsx)(n.code,{children:"rules.json"})}),", in order to instruct Mariana Trench to find data flow that matches the new rule."]}),"\n",(0,t.jsxs)(n.li,{children:["For example, to catch flows from ",(0,t.jsx)(n.code,{children:"TestSensitiveUserInput"})," in the example above and the sink kind ",(0,t.jsx)(n.code,{children:"Logging"}),", you can add the following rule to the default ",(0,t.jsx)(n.a,{href:"https://github.com/facebook/mariana-trench/blob/main/configuration/rules.json",children:(0,t.jsx)(n.code,{children:"rules.json"})}),":"]}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n "name": "TestRule",\n "code": 18,\n "description": "A test rule",\n "sources": [\n   "TestSensitiveUserInput"\n ],\n "sinks": [\n   "Logging"\n ]\n}\n'})}),"\n"]}),"\n"]})]})]})}function m(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(h,{...e})}):h(e)}},88447(e,n,s){s.r(n),s.d(n,{assets:()=>c,contentTitle:()=>a,default:()=>u,frontMatter:()=>i,metadata:()=>r,toc:()=>d});const r=JSON.parse('{"id":"fb/customize_sources_and_sinks","title":"customize_sources_and_sinks","description":"","source":"@site/documentation/fb/customize_sources_and_sinks.md","sourceDirName":"fb","slug":"/fb/customize_sources_and_sinks","permalink":"/docs/fb/customize_sources_and_sinks","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/mariana-trench/tree/main/documentation/website/documentation/fb/customize_sources_and_sinks.md","tags":[],"version":"current","frontMatter":{}}');var t=s(74848),o=s(28453);const i={},a=void 0,c={},d=[];function l(e){return(0,t.jsx)(t.Fragment,{})}function u(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(l,{...e})}):l()}},28453(e,n,s){s.d(n,{R:()=>i,x:()=>a});var r=s(96540);const t={},o=r.createContext(t);function i(e){const n=r.useContext(o);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:i(e.components),r.createElement(o.Provider,{value:n},e.children)}}}]);