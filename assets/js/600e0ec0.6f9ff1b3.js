"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[811],{3905:(e,n,t)=>{t.r(n),t.d(n,{MDXContext:()=>s,MDXProvider:()=>m,mdx:()=>y,useMDXComponents:()=>f,withMDXComponents:()=>d});var r=t(67294);function i(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function a(){return a=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},a.apply(this,arguments)}function o(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function l(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?o(Object(t),!0).forEach((function(n){i(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):o(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function c(e,n){if(null==e)return{};var t,r,i=function(e,n){if(null==e)return{};var t,r,i={},a=Object.keys(e);for(r=0;r<a.length;r++)t=a[r],n.indexOf(t)>=0||(i[t]=e[t]);return i}(e,n);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)t=a[r],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(i[t]=e[t])}return i}var s=r.createContext({}),d=function(e){return function(n){var t=f(n.components);return r.createElement(e,a({},n,{components:t}))}},f=function(e){var n=r.useContext(s),t=n;return e&&(t="function"==typeof e?e(n):l(l({},n),e)),t},m=function(e){var n=f(e.components);return r.createElement(s.Provider,{value:n},e.children)},u={inlineCode:"code",wrapper:function(e){var n=e.children;return r.createElement(r.Fragment,{},n)}},p=r.forwardRef((function(e,n){var t=e.components,i=e.mdxType,a=e.originalType,o=e.parentName,s=c(e,["components","mdxType","originalType","parentName"]),d=f(t),m=i,p=d["".concat(o,".").concat(m)]||d[m]||u[m]||a;return t?r.createElement(p,l(l({ref:n},s),{},{components:t})):r.createElement(p,l({ref:n},s))}));function y(e,n){var t=arguments,i=n&&n.mdxType;if("string"==typeof e||i){var a=t.length,o=new Array(a);o[0]=p;var l={};for(var c in n)hasOwnProperty.call(n,c)&&(l[c]=n[c]);l.originalType=e,l.mdxType="string"==typeof e?e:i,o[1]=l;for(var s=2;s<a;s++)o[s]=t[s];return r.createElement.apply(null,o)}return r.createElement.apply(null,t)}p.displayName="MDXCreateElement"},83703:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>s,contentTitle:()=>l,default:()=>p,frontMatter:()=>o,metadata:()=>c,toc:()=>d});var r=t(87462),i=(t(67294),t(3905)),a=t(86341);const o={id:"android-lifecycles",title:"Android/API Lifcycles",sidebar_label:"Android/API Lifcycles"},l=void 0,c={unversionedId:"android-lifecycles",id:"android-lifecycles",title:"Android/API Lifcycles",description:"Background",source:"@site/documentation/android_lifecycles.md",sourceDirName:".",slug:"/android-lifecycles",permalink:"/docs/android-lifecycles",draft:!1,editUrl:"https://github.com/facebook/mariana-trench/tree/main/documentation/website/documentation/android_lifecycles.md",tags:[],version:"current",frontMatter:{id:"android-lifecycles",title:"Android/API Lifcycles",sidebar_label:"Android/API Lifcycles"},sidebar:"docs",previous:{title:"Shims",permalink:"/docs/shims"},next:{title:"Feature Glossary",permalink:"/docs/feature-descriptions"}},s={},d=[{value:"Background",id:"background",level:2},{value:"Life-cycle Configuration",id:"life-cycle-configuration",level:2},{value:"Life-cycle Definition",id:"life-cycle-definition",level:2}],f=(m="FbAndroidLifecycles",function(e){return console.warn("Component "+m+" was not imported, exported, or provided by MDXProvider as global scope"),(0,i.mdx)("div",e)});var m;const u={toc:d};function p(e){let{components:n,...t}=e;return(0,i.mdx)("wrapper",(0,r.Z)({},u,t,{components:n,mdxType:"MDXLayout"}),(0,i.mdx)("h2",{id:"background"},"Background"),(0,i.mdx)("p",null,"Framework classes often provide overridable methods that subclasses can override. These methods are frequently executed in some sequence. The most direct example of this would be the ",(0,i.mdx)("a",{parentName:"p",href:"https://developer.android.com/guide/components/activities/activity-lifecycle"},"Activity life-cycle"),". Sub-classes implement methods like onCreate(), onStart(), onResume(), etc. which is internally chained up in the base class."),(0,i.mdx)("p",null,"The analysis may see this chain if the code for the base class is available. However, because the base class can be overridden by many different children, the analysis cannot easily differentiate between flows ",(0,i.mdx)("inlineCode",{parentName:"p"},"Child1.onCreate() -> Child1.onStart()")," and ",(0,i.mdx)("inlineCode",{parentName:"p"},"Child1.onCreate() -> Child2.onStart()"),". The latter could result in a false positives. There could also be too many children and which causes the analysis to drop taint and fail to find any flow."),(0,i.mdx)("p",null,"To get around this, we allow users to define life-cycles for these framework classes."),(0,i.mdx)("h2",{id:"life-cycle-configuration"},"Life-cycle Configuration"),(0,i.mdx)(a.FbInternalOnly,{mdxType:"FbInternalOnly"}," ",(0,i.mdx)(f,{mdxType:"FbAndroidLifecycles"})," "),(0,i.mdx)(a.OssOnly,{mdxType:"OssOnly"},(0,i.mdx)("p",null,"The default life-cycles are defined in ",(0,i.mdx)("a",{parentName:"p",href:"https://github.com/facebook/mariana-trench/blob/main/configuration/lifecycles.json"},"configuration/lifecycles.json"),".")),(0,i.mdx)("h2",{id:"life-cycle-definition"},"Life-cycle Definition"),(0,i.mdx)("p",null,"Life-cycles are defined in a JSON file and passed into the analysis via the ",(0,i.mdx)("inlineCode",{parentName:"p"},"--lifecycles-paths")," option. Here is a sample definition."),(0,i.mdx)("pre",null,(0,i.mdx)("code",{parentName:"pre"},'  {\n    "base_class_name": "Landroidx/fragment/app/FragmentActivity;",\n    "method_name": "activity_lifecycle_wrapper",\n    "callees": [\n      {\n        "method_name": "onCreate",\n        "return_type": "V",\n        "argument_types": [\n          "Landroid/os/Bundle;"\n        ]\n      },\n      {\n        "method_name": "onStart",\n        "return_type": "V",\n        "argument_types": []\n      }\n    ]\n  },\n')),(0,i.mdx)("p",null,"Most of the fields should be self-explanatory, with just a few additional notes:"),(0,i.mdx)("ul",null,(0,i.mdx)("li",{parentName:"ul"},"The analysis internally creates artificial methods with signature ",(0,i.mdx)("inlineCode",{parentName:"li"},"<child of base_class_name>.<method_name>(args for callees)"),' that calls the "callees" in the defined sequence.'),(0,i.mdx)("li",{parentName:"ul"},'"method_name" must be unique across all life-cycles. Children could extend multiple base classes. If their respective life-cycle definitions share a "method_name", there will be a conflict.'),(0,i.mdx)("li",{parentName:"ul"},"Only children at the leaves of the class hierarchy will have the artificial method created, so taint flow will only be detected in these classes.")))}p.isMDXComponent=!0}}]);